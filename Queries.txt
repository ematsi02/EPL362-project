// --- Consultation Reports Menu

// ---------
Attended Daily Consultations

String MyDate="'2017-05-05'";
String MyDate="'2017-05-14'";

Select Consultation.ConsultationID, Consultation.Subject, Consultation.Date, Consultation.Time, Patient.PatientID, Patient.Name, Patient.Surname, Staff.StaffID, Staff.Name, Staff.Surname, Consultation.MedicalRecordUpdated
From Patient, Consultation, Staff
Where Consultation.Attended='1' AND Consultation.Date=MyDate
AND Patient.PatientID=Consultation.PatientID 
AND Consultation.StaffID=Staff.StaffID;

// ---------
Attended General Consultations

Select Consultation.ConsultationID, Consultation.Subject, Consultation.Date, Consultation.Time, Patient.PatientID, Patient.Name, Patient.Surname, Staff.StaffID, Staff.Name, Staff.Surname, Consultation.MedicalRecordUpdated
From Patient, Consultation, Staff
Where Consultation.Attended='1'
AND Patient.PatientID=Consultation.PatientID 
AND Consultation.StaffID=Staff.StaffID;

// ---------
Non Attended Daily Consultations

String MyDate="'2017-05-05'";
String MyDate="'2017-05-14'";

Select Consultation.ConsultationID, Consultation.Subject, Consultation.Date, Consultation.Time, Patient.PatientID, Patient.Name, Patient.Surname, Staff.StaffID, Staff.Name, Staff.Surname, Consultation.MedicalRecordUpdated
From Patient, Consultation, Staff
Where Consultation.Attended='0' AND Consultation.Date=MyDate
AND Patient.PatientID=Consultation.PatientID 
AND Consultation.StaffID=Staff.StaffID;

// ---------
Non Attended General Consultations

Select Consultation.ConsultationID, Consultation.Subject, Consultation.Date, Consultation.Time, Patient.PatientID, Patient.Name, Patient.Surname, Staff.StaffID, Staff.Name, Staff.Surname, Consultation.MedicalRecordUpdated
From Patient, Consultation, Staff
Where Consultation.Attended='0'
AND Patient.PatientID=Consultation.PatientID 
AND Consultation.StaffID=Staff.StaffID;

// ---------
Non Updated Daily Medical Records

String MyDate="'2017-05-14'";

Select Consultation.ConsultationID, Consultation.Subject, Consultation.Date, Consultation.Time, Patient.PatientID, Patient.Name, Patient.Surname, Staff.StaffID, Staff.Name, Staff.Surname, Consultation.MedicalRecordUpdated
From Patient, Consultation, Staff
Where Consultation.Attended='1' AND Consultation.Date=MyDate
AND Consultation.MedicalRecordUpdated='0'
AND Patient.PatientID=Consultation.PatientID 
AND Consultation.StaffID=Staff.StaffID;

// ---------
Non Updated General Medical Records

Select Consultation.ConsultationID, Consultation.Subject, Consultation.Date, Consultation.Time, Patient.PatientID, Patient.Name, Patient.Surname, Staff.StaffID, Staff.Name, Staff.Surname, Consultation.MedicalRecordUpdated
From Patient, Consultation, Staff
Where Consultation.Attended='1'
AND Consultation.MedicalRecordUpdated='0'
AND Patient.PatientID=Consultation.PatientID 
AND Consultation.StaffID=Staff.StaffID;


// --- Patient Reports  Menu

// ---------
Changes of Patient Profiles

Select Patient.* 
From Patient
Where Patient.ChangedByPatient='1';

// ---------
Patients with specific Condition

String condition="Depression";

Select Patient.*
From Patient, Treatment
Where Treatment.Diagnosis=condition
AND Patient.PatientID=Treatment.PatientID
Group By Patient.PatientID;

// ---------
Patients with specific Treatment/Medication

String medName="'Medication 1'";

Select Patient.* 
From Patient, Treatment, TreatmentMedication, Medication
Where Medication.Name=medName
AND Patient.PatientID=Treatment.PatientID
AND Treatment.TreatmentID=TreatmentMedication.TreatmentID
AND TreatmentMedication.MedicationID=Medication.MedicationID
Group By Patient.PatientID;

// --- General Reports Menu

// ---------
Number of Patients Attended

Select COUNT(Consultation.PatientID), Consultation.Date
From Consultation
Where Consultation.Attended='1'
Group By Consultation.Date
Order By COUNT(Consultation.PatientID);

// ---------
Number of Patients by Condition

Select COUNT(Treatment.PatientID), Treatment.Diagnosis  
From Treatment
Group By Treatment.Diagnosis
Order By COUNT(PatientID) DESC;

// ---------
Number of Patients by Treatment/Medication

Select COUNT(Treatment.PatientID), Medication.MedicationID, Medication.Name
From Treatment, TreatmentMedication, Medication
Where Treatment.TreatmentID=TreatmentMedication.TreatmentID
AND TreatmentMedication.MedicationID=Medication.MedicationID
Group By Treatment.PatientID
Order By COUNT(Treatment.PatientID) DESC;

// ---------
Medication prescriptions summary

Select *
From Treatment, TreatmentMedication, Medication
Where Treatment.TreatmentID=TreatmentMedication.TreatmentID
AND TreatmentMedication.MedicationID=Medication.MedicationID;

// Select top row, latest date

SELECT * 
FROM `Treatment` 
WHERE `PatientID`='un'
order by StartDate desc
Limit 1
